import{_ as i,c as a,a as e,o as n}from"./app-N-E0fQEa.js";const t={};function l(h,s){return n(),a("div",null,s[0]||(s[0]=[e(`<h2 id="解决-ssl-certificate-verify-failed-的问题" tabindex="-1"><a class="header-anchor" href="#解决-ssl-certificate-verify-failed-的问题"><span>解决 <code>SSL: CERTIFICATE_VERIFY_FAILED</code> 的问题</span></a></h2><p>最近使用 <code>LangBot</code> 或者 <code>AstrBot</code> 时遇到了关于 <code>SSL</code> 的问题：</p><div class="language-log line-numbers-mode" data-ext="log" data-title="log"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Cannot connect to host </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">api.github.com</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">443</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ssl:True [SSLCertVerificationError: (</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">1</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&#39;[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1000)&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="下面是解决的方案以及步骤" tabindex="-1"><a class="header-anchor" href="#下面是解决的方案以及步骤"><span>下面是解决的方案以及步骤：</span></a></h2><h3 id="一、在相关代码里面增加了基于-certifi-的-ssl-上下文的设置" tabindex="-1"><a class="header-anchor" href="#一、在相关代码里面增加了基于-certifi-的-ssl-上下文的设置"><span>一、在相关代码里面增加了基于 <code>certifi</code> 的 <code>SSL</code> 上下文的设置</span></a></h3><p>首先确保安装了 <code>certifi</code> 库，如果没有安装，需要通过 <code>pip install certifi</code> 来安装。一般 <code>ssl</code> 不需要额外安装。</p><p>比如：</p><div class="language-python line-numbers-mode" data-ext="python" data-title="python"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">class</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> SimpleGoogleGenAIClient</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    def</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> __init__</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> api_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> api_base</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> timeout</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> int</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 120</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> -&gt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> None</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">api_key </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> api_key</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        if</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> api_base</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">endswith</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">):</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">            self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">api_base </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> api_base</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        else</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">            self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">api_base </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> api_base</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">client </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> aiohttp</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ClientSession</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">trust_env</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">True</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">timeout </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> timeout</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>修改后：</p><div class="language-python line-numbers-mode" data-ext="python" data-title="python"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">class</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> SimpleGoogleGenAIClient</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    def</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> __init__</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> api_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> api_base</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> timeout</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> int</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 120</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> -&gt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> None</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line highlighted"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ssl</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> certifi                                               </span></span>
<span class="line highlighted"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">api_key </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> api_key </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        if</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> api_base</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">endswith</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">):</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">            self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">api_base </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> api_base</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        else</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">            self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">api_base </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> api_base</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">timeout </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> timeout</span></span>
<span class="line highlighted"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        ssl_context </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ssl</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">create_default_context</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">cafile</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">certifi</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">where</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">())</span></span>
<span class="line highlighted"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        connector </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> aiohttp</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">TCPConnector</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">ssl</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ssl_context</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line highlighted"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">client </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> aiohttp</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ClientSession</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">trust_env</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">True</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> connector</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">connector</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">注意</p><p>注意： <code>import ssl, certifi</code> 可能不符合合 <code>Ruff</code> 规范，需要分别单独写在代码顶部。</p></div><h4 id="后面需要定期更新-certifi-证书" tabindex="-1"><a class="header-anchor" href="#后面需要定期更新-certifi-证书"><span>后面需要定期更新 <code>certifi</code> 证书</span></a></h4><p>如果你在虚拟环境 (<code>venv</code>) 里运行 Python，可能 <code>certifi</code> 证书库需要更新：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pip</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --upgrade</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> certifi</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>然后尝试运行：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">python</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -c</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">import ssl; print(ssl.get_default_verify_paths())</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>如果证书路径不正确，可以手动设置：</p><div class="language-python line-numbers-mode" data-ext="python" data-title="python"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ssl</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> certifi</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ssl_context </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ssl</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">create_default_context</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">cafile</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">certifi</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">where</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">())</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="解决方案-2-临时禁用-ssl-验证-不推荐" tabindex="-1"><a class="header-anchor" href="#解决方案-2-临时禁用-ssl-验证-不推荐"><span>解决方案 2：临时禁用 SSL 验证（不推荐）</span></a></h3><p>如果你只是临时调试，可以绕过 SSL 验证：</p><div class="language-python line-numbers-mode" data-ext="python" data-title="python"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ssl</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> aiohttp</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ssl_context </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ssl</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">create_default_context</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span>
<span class="line highlighted"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ssl_context</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">check_hostname </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> False</span></span>
<span class="line highlighted"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ssl_context</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">verify_mode </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ssl</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">CERT_NONE</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">async</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> with</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> aiohttp</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ClientSession</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">connector</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">aiohttp</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">TCPConnector</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">ssl</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ssl_context</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> as</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> session</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    async</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> with</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> session</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">get</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">https://api.github.com</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> as</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> resp</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">        print</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">await</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> resp</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">text</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">())</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">注意</p><p>但请注意，这种临时禁用 <code>SSL</code> 验证做法不安全，仅用于测试。</p></div><p>通过以上的方式的确解决了问题，但是别人写的代码不一定每次都会传入 <code>SSL</code> 上下文，需要自己每次修改代码就很麻烦。所以就有了下面的方案。</p><h2 id="二、配置-certifi-证书" tabindex="-1"><a class="header-anchor" href="#二、配置-certifi-证书"><span>二、配置 <code>certifi</code> 证书</span></a></h2><p>以 <code>Ubuntu 24.04.2 LTS (GNU/Linux 6.8.0-55-generic x86_64)</code> 为例</p><h3 id="解决方案-3-重新安装-python" tabindex="-1"><a class="header-anchor" href="#解决方案-3-重新安装-python"><span>解决方案 3：重新安装 Python</span></a></h3><p>某些情况下，Python 自带的 <code>ssl</code> 模块可能缺失 CA 证书。你可以尝试重新安装 Python，并确保在安装后运行：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pip</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> python-certifi-win32</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="解决方案-4-手动更新-ca-证书" tabindex="-1"><a class="header-anchor" href="#解决方案-4-手动更新-ca-证书"><span>解决方案 4：手动更新 CA 证书</span></a></h3><p>如果 <code>certifi</code> 仍然无法解决，尝试手动更新 CA 证书：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> update-ca-certificates</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>后面我通过 <code>python -c &quot;import ssl; print(ssl.get_default_verify_paths())&quot;</code> 了解到证书的目录：</p><div class="language-log line-numbers-mode" data-ext="log" data-title="log"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">DefaultVerifyPaths</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    (</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        cafile=None,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        capath=</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&#39;/usr/local/openssl111/certs&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        openssl_cafile_env=</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&#39;SSL_CERT_FILE&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        openssl_cafile=</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&#39;/usr/local/openssl111/cert.pem&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        openssl_capath_env=</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&#39;SSL_CERT_DIR&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        openssl_capath=</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&#39;/usr/local/openssl111/certs&#39;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    )</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后看了一眼 <code>/usr/local/openssl111/certs</code> 目录，结果里面是空的，什么也没有，但是考虑到之前用了下面的指令解决问题，应该不存在没有的情况。</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apt</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> update</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &amp;&amp;</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apt</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --reinstall</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ca-certificates</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>后面发现证书实际是在 <code>/etc/ssl/certs/</code> 里面，接着就直接用</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cp</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -r</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/ssl/certs/</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">*</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/local/openssl111/certs/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>复制粘贴了过去，最后解决了问题。</p><h2 id="以下是我在网上找到的解决方案-适用于-windows-但我没有实践过。" tabindex="-1"><a class="header-anchor" href="#以下是我在网上找到的解决方案-适用于-windows-但我没有实践过。"><span>以下是我在网上找到的解决方案，适用于 <code>Windows</code> ，但我没有实践过。</span></a></h2><p>这个错误：</p><div class="language-plaintext line-numbers-mode" data-ext="plaintext" data-title="plaintext"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>Cannot connect to host api.github.com:443 ssl:True [SSLCertVerificationError: (1, &#39;[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1000)&#39;)]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>表明 <strong>Python 无法验证 GitHub API 的 SSL 证书</strong>，通常是由于 SSL 证书丢失、过期或 Python 的 <code>certifi</code> 证书存储未正确配置。</p><h2 id="可能的原因" tabindex="-1"><a class="header-anchor" href="#可能的原因"><span><strong>可能的原因</strong></span></a></h2><ol><li><strong>Python 证书未安装或损坏</strong><ul><li><code>certifi</code> 证书包未正确安装或损坏。</li></ul></li><li><strong>Python 未正确配置 SSL 证书</strong><ul><li>OpenSSL 无法找到 <code>cacert.pem</code> 证书文件。</li></ul></li><li><strong>系统时间不正确</strong><ul><li>如果系统时间不正确，SSL 证书可能会被视为无效。</li></ul></li><li><strong>网络问题</strong><ul><li>代理、VPN 或防火墙可能会阻止 SSL 连接。</li></ul></li></ol><h2 id="解决方案" tabindex="-1"><a class="header-anchor" href="#解决方案"><span><strong>解决方案</strong></span></a></h2><h3 id="方法-1-手动安装-ssl-证书" tabindex="-1"><a class="header-anchor" href="#方法-1-手动安装-ssl-证书"><span><strong>方法 1：手动安装 SSL 证书</strong></span></a></h3><p>在 macOS 和 Windows 上，Python 自带了 <code>Install Certificates.command</code> 脚本来更新 CA 证书。</p><h4 id="windows-macos" tabindex="-1"><a class="header-anchor" href="#windows-macos"><span><strong>Windows/macOS</strong></span></a></h4><ol><li>找到 Python 安装目录（如 <code>C:\\Program Files\\PythonXX</code> 或 <code>/Applications/Python3.X/</code>）。</li><li>运行以下脚本： <ul><li><strong>Windows</strong>（在命令提示符 <code>cmd</code> 中运行）：<div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">C:\\Program</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Files</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\P</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ythonXX</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\p</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ython.exe</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -m</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pip</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --upgrade</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> certifi</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><strong>macOS</strong>（在终端中运行）：<div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">/Applications/Python3.X/Install\\</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Certificates.command</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li></ol><p>如果这步解决了问题，说明你的 CA 证书丢失或损坏了。</p><h3 id="方法-2-更新-certifi-证书" tabindex="-1"><a class="header-anchor" href="#方法-2-更新-certifi-证书"><span><strong>方法 2：更新 <code>certifi</code> 证书</strong></span></a></h3><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pip</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --upgrade</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> certifi</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>然后检查 <code>certifi</code> 证书路径：</p><div class="language-python line-numbers-mode" data-ext="python" data-title="python"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> certifi</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">print</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">certifi</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">where</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">())</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 查看 \`cacert.pem\` 位置</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>如果仍然出错，你可以手动替换 <code>cacert.pem</code>：</p><ol><li><strong>下载最新的 CA 证书</strong>：<a href="https://curl.se/ca/cacert.pem" target="_blank" rel="noopener noreferrer">https://curl.se/ca/cacert.pem</a></li><li><strong>覆盖 <code>certifi</code> 证书文件</strong>： <ul><li>运行 <code>python -c &quot;import certifi; print(certifi.where())&quot;</code> 找到 <code>cacert.pem</code> 位置。</li><li>用新下载的 <code>cacert.pem</code> 替换该文件。</li></ul></li></ol><h3 id="方法-3-指定证书路径" tabindex="-1"><a class="header-anchor" href="#方法-3-指定证书路径"><span><strong>方法 3：指定证书路径</strong></span></a></h3><p>如果 <code>certifi</code> 没有正确加载，你可以在代码中手动指定证书路径：</p><div class="language-python line-numbers-mode" data-ext="python" data-title="python"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ssl</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> certifi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ssl_context </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ssl</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">create_default_context</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">cafile</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">certifi</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">where</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">())</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> urllib</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">request</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">urllib</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">request</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">urlopen</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">https://api.github.com</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> context</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ssl_context</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这样可以确保 Python 使用 <code>certifi</code> 提供的证书文件。</p><h3 id="方法-4-重装-python" tabindex="-1"><a class="header-anchor" href="#方法-4-重装-python"><span><strong>方法 4：重装 Python</strong></span></a></h3><p>如果所有方法都失败，建议重装 Python：</p><ol><li><strong>卸载 Python</strong>（勾选“删除所有用户数据”）。</li><li><strong>从 Python 官网下载安装最新版本</strong>：<a href="https://www.python.org/downloads/" target="_blank" rel="noopener noreferrer">https://www.python.org/downloads/</a>。</li><li><strong>运行 <code>Install Certificates.command</code> 脚本（macOS 需要）</strong>。</li></ol><h3 id="方法-5-检查系统时间" tabindex="-1"><a class="header-anchor" href="#方法-5-检查系统时间"><span><strong>方法 5：检查系统时间</strong></span></a></h3><p>SSL 证书验证依赖于正确的系统时间，如果你的时间不正确，会导致证书验证失败：</p><ul><li>Windows：<div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">w32tm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /resync</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li>macOS/Linux：<div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ntpdate</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> time.apple.com</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # macOS</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> timedatectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> set-ntp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> on</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # Linux</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span><strong>总结</strong></span></a></h2><p>✅ <strong>推荐做法</strong>：</p><ol><li>运行 <code>Install Certificates.command</code>（macOS/Windows）。</li><li><code>pip install --upgrade certifi</code> 并替换 <code>cacert.pem</code>。</li><li>手动指定 <code>ssl.create_default_context(cafile=certifi.where())</code>。</li><li>检查系统时间是否正确。</li><li>重新安装 Python（如果其他方法无效）。</li></ol>`,69)]))}const k=i(t,[["render",l],["__file","17.html.vue"]]),d=JSON.parse('{"path":"/tech/17.html","title":"记录：解决 CA 证书的问题","lang":"zh-CN","frontmatter":{"title":"记录：解决 CA 证书的问题","description":"解决 SSL: CERTIFICATE_VERIFY_FAILED 的问题 最近使用 LangBot 或者 AstrBot 时遇到了关于 SSL 的问题： 下面是解决的方案以及步骤： 一、在相关代码里面增加了基于 certifi 的 SSL 上下文的设置 首先确保安装了 certifi 库，如果没有安装，需要通过 pip install certifi...","head":[["meta",{"property":"og:url","content":"https://docs.wenturc.com/tech/17.html"}],["meta",{"property":"og:site_name","content":"WentUrc Docs"}],["meta",{"property":"og:title","content":"记录：解决 CA 证书的问题"}],["meta",{"property":"og:description","content":"解决 SSL: CERTIFICATE_VERIFY_FAILED 的问题 最近使用 LangBot 或者 AstrBot 时遇到了关于 SSL 的问题： 下面是解决的方案以及步骤： 一、在相关代码里面增加了基于 certifi 的 SSL 上下文的设置 首先确保安装了 certifi 库，如果没有安装，需要通过 pip install certifi..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-03T02:51:39.000Z"}],["meta",{"property":"article:modified_time","content":"2025-04-03T02:51:39.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"记录：解决 CA 证书的问题\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-04-03T02:51:39.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"解决 SSL: CERTIFICATE_VERIFY_FAILED 的问题","slug":"解决-ssl-certificate-verify-failed-的问题","link":"#解决-ssl-certificate-verify-failed-的问题","children":[]},{"level":2,"title":"下面是解决的方案以及步骤：","slug":"下面是解决的方案以及步骤","link":"#下面是解决的方案以及步骤","children":[{"level":3,"title":"一、在相关代码里面增加了基于 certifi 的 SSL 上下文的设置","slug":"一、在相关代码里面增加了基于-certifi-的-ssl-上下文的设置","link":"#一、在相关代码里面增加了基于-certifi-的-ssl-上下文的设置","children":[]},{"level":3,"title":"解决方案 2：临时禁用 SSL 验证（不推荐）","slug":"解决方案-2-临时禁用-ssl-验证-不推荐","link":"#解决方案-2-临时禁用-ssl-验证-不推荐","children":[]}]},{"level":2,"title":"二、配置 certifi 证书","slug":"二、配置-certifi-证书","link":"#二、配置-certifi-证书","children":[{"level":3,"title":"解决方案 3：重新安装 Python","slug":"解决方案-3-重新安装-python","link":"#解决方案-3-重新安装-python","children":[]},{"level":3,"title":"解决方案 4：手动更新 CA 证书","slug":"解决方案-4-手动更新-ca-证书","link":"#解决方案-4-手动更新-ca-证书","children":[]}]},{"level":2,"title":"以下是我在网上找到的解决方案，适用于 Windows ，但我没有实践过。","slug":"以下是我在网上找到的解决方案-适用于-windows-但我没有实践过。","link":"#以下是我在网上找到的解决方案-适用于-windows-但我没有实践过。","children":[]},{"level":2,"title":"可能的原因","slug":"可能的原因","link":"#可能的原因","children":[]},{"level":2,"title":"解决方案","slug":"解决方案","link":"#解决方案","children":[{"level":3,"title":"方法 1：手动安装 SSL 证书","slug":"方法-1-手动安装-ssl-证书","link":"#方法-1-手动安装-ssl-证书","children":[]},{"level":3,"title":"方法 2：更新 certifi 证书","slug":"方法-2-更新-certifi-证书","link":"#方法-2-更新-certifi-证书","children":[]},{"level":3,"title":"方法 3：指定证书路径","slug":"方法-3-指定证书路径","link":"#方法-3-指定证书路径","children":[]},{"level":3,"title":"方法 4：重装 Python","slug":"方法-4-重装-python","link":"#方法-4-重装-python","children":[]},{"level":3,"title":"方法 5：检查系统时间","slug":"方法-5-检查系统时间","link":"#方法-5-检查系统时间","children":[]}]},{"level":2,"title":"总结","slug":"总结","link":"#总结","children":[]}],"readingTime":{"minutes":4.42,"words":1327},"git":{"createdTime":1742994474000,"updatedTime":1743648699000,"contributors":[{"name":"LI SONGSONG","email":"IGCrystal@wenturc.com","commits":5,"url":"https://github.com/LI SONGSONG"},{"name":"冰苷晶","email":"2749332490@qq.com","commits":2,"url":"https://github.com/冰苷晶"}]},"autoDesc":true,"filePathRelative":"tech/17.md","categoryList":[{"id":"d9f913","sort":10008,"name":"tech"}],"bulletin":false}');export{k as comp,d as data};
